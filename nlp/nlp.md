## n-gram



## CBOW

**CBOW**ï¼ˆContinuous Bag-of-Wordsï¼‰æ˜¯ Word2Vec ä¸­çš„**ä¸¤å¤§æ ¸å¿ƒç®—æ³•ä¹‹ä¸€**ï¼ˆå¦ä¸€ä¸º Skip-gramï¼‰ï¼Œç”± Mikolov ç­‰äººäº 2013 å¹´æå‡ºï¼Œç”¨äº**å­¦ä¹ è¯å‘é‡**ï¼ˆword embeddingsï¼‰ã€‚

ä¸‹é¢ç”¨**æ¸…æ™°ç»“æ„ + ç›´è§‚å›¾ç¤º + ä¸ä½ èƒŒæ™¯å…³è”**çš„æ–¹å¼è§£æï¼š

### ğŸ”‘ ä¸€ã€CBOW çš„æ ¸å¿ƒæ€æƒ³ï¼ˆä¸€å¥è¯ï¼‰ï¼š

> **â€œé€šè¿‡ä¸Šä¸‹æ–‡è¯é¢„æµ‹ä¸­å¿ƒè¯â€** â€”â€” å³ç”¨ä¸€ä¸ªè¯çš„**å‘¨å›´è¯**ï¼ˆcontextï¼‰æ¥é¢„æµ‹å®ƒæœ¬èº«ã€‚ 

ğŸ“Œ ç±»æ¯”ï¼š

> å®Œå½¢å¡«ç©ºï¼š
> â€œå˜å‹å™¨åœ¨ ___ kV ä¸‹è¿è¡Œâ€ â†’ ç”¨â€œå˜å‹å™¨â€â€œåœ¨â€â€œkVâ€â€œä¸‹â€â€œè¿è¡Œâ€é¢„æµ‹ç©ºæ ¼è¯ï¼ˆå¦‚â€œ110â€ï¼‰ã€‚ 

### ğŸ“ äºŒã€æ•°å­¦å»ºæ¨¡

è®¾ï¼š

- è¯å…¸å¤§å°ï¼š*V*
- è¯å‘é‡ç»´åº¦ï¼š*d*
- è¾“å…¥å±‚ï¼šä¸Šä¸‹æ–‡è¯çš„**one-hot å‘é‡** **x**1,â€¦,**x**2*m* ï¼ˆçª—å£å¤§å° 2*m* ï¼‰
- éšè—å±‚ï¼š**è¯å‘é‡å¹³å‡**ï¼ˆBag-of-Words çš„ä½“ç°ï¼‰
- è¾“å‡ºå±‚ï¼šé¢„æµ‹ä¸­å¿ƒè¯çš„æ¦‚ç‡åˆ†å¸ƒ

#### âœ… ç½‘ç»œç»“æ„ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š



è¾“å…¥å±‚ï¼ˆ2m ä¸ªè¯ï¼‰ 

   â†“

è¯å‘é‡çŸ©é˜µ Wï¼ˆVÃ—dï¼‰â†’ æŸ¥è¡¨å¾— vâ‚, vâ‚‚, ..., v_{2m}

   â†“

éšè—å±‚ h = (vâ‚ + vâ‚‚ + ... + v_{2m}) / (2m)   â† å…³é”®ï¼šå¹³å‡ï¼

   â†“

è¾“å‡ºå±‚ softmax:  Å· = softmax(W' Â· h)         ï¼ˆW' æ˜¯è¾“å‡ºæƒé‡çŸ©é˜µï¼‰

#### âœ… è®­ç»ƒç›®æ ‡ï¼š

æœ€å¤§åŒ–ä¸­å¿ƒè¯ *w*0 çš„æ¡ä»¶æ¦‚ç‡ï¼š



maxlog*P*(*w*0âˆ£*w*âˆ’*m*,â€¦,*w*âˆ’1,*w*1,â€¦,*w**m*)

### ğŸ–¼ï¸ ä¸‰ã€å›¾è§£ CBOWï¼ˆçª—å£å¤§å°=2ï¼‰

å¥å­ï¼š [The] [voltage] [of] [transformer] [is] [110] [kV]

â€‹                     â†‘

â€‹                  ä¸­å¿ƒè¯ wâ‚€ = "transformer"

â€‹        ä¸Šä¸‹æ–‡ï¼š wâ‚‹â‚‚="voltage", wâ‚‹â‚="of", wâ‚="is", wâ‚‚="110"

è¾“å…¥ï¼š ["voltage", "of", "is", "110"] 

â†’ æŸ¥å‘é‡ â†’ å¹³å‡ â†’ é¢„æµ‹ "transformer"

### âœ… å››ã€CBOW çš„ç‰¹ç‚¹ï¼ˆvs Skip-gramï¼‰

| ç‰¹æ€§             | CBOW                                     | Skip-gram                                |
| ---------------- | ---------------------------------------- | ---------------------------------------- |
| **è®­ç»ƒç›®æ ‡**     | ä¸Šä¸‹æ–‡ â†’ ä¸­å¿ƒè¯                          | ä¸­å¿ƒè¯ â†’ ä¸Šä¸‹æ–‡                          |
| **æ”¶æ•›é€Ÿåº¦**     | âœ… æ›´å¿«ï¼ˆæ¢¯åº¦æ¥è‡ªå¤šä¸ªè¯å¹³å‡ï¼Œæ›´ç¨³å®šï¼‰     | è¾ƒæ…¢                                     |
| **å°é¢‘è¯è¡¨ç¤º**   | âŒ è¾ƒå¼±ï¼ˆä½é¢‘è¯å¸¸ä½œä¸Šä¸‹æ–‡ï¼Œæ˜“è¢«å¹³å‡æ·¹æ²¡ï¼‰ | âœ… æ›´å¥½ï¼ˆä½é¢‘è¯å¯ä½œä¸­å¿ƒè¯è¢«é‡ç‚¹å­¦ä¹ ï¼‰     |
| **é€‚åˆæ•°æ®é‡**   | ä¸­å°è§„æ¨¡è¯­æ–™                             | å¤§è§„æ¨¡è¯­æ–™                               |
| **ä½ çš„åœºæ™¯é€‚é…** | è®¾å¤‡æ–‡æ¡£æœ¯è¯­è¾ƒè§„èŒƒã€é«˜é¢‘ â†’ CBOW è¶³å¤Ÿ     | è‹¥å«å¤§é‡ä¸“ä¸šç¼©å†™/ä½é¢‘è¯ â†’ Skip-gram æ›´ä¼˜ |

> ğŸ’¡ ä½ åœ¨å¤„ç†**ç”µå‹ç­‰çº§+è®¾å¤‡å**ï¼ˆå¦‚ `"110kVå˜å‹å™¨"`ï¼‰è¿™ç±»å›ºå®šæ­é…æ—¶ï¼ŒCBOW èƒ½å¾ˆå¥½æ•è· `"110kV"` ä¸ `"å˜å‹å™¨"` çš„å…±ç°å…³ç³»ã€‚ 

### ğŸ› ï¸ äº”ã€PyTorch ä¼ªä»£ç ï¼ˆç®€åŒ–ç‰ˆï¼‰

\# è¾“å…¥ï¼šcontext_ids = [id1, id2, id3, id4]ï¼ˆ4ä¸ªä¸Šä¸‹æ–‡è¯ï¼‰

\#       target_id = center_word_id

\# 1. æŸ¥è¯å‘é‡

embeddings = word_embedding(torch.LongTensor(context_ids))  # [4, d]

\# 2. å¹³å‡ â†’ éšè—å±‚

h = torch.mean(embeddings, dim=0)  # [d]

\# 3. è¾“å‡ºå±‚ï¼ˆè´Ÿé‡‡æ ·æ›´é«˜æ•ˆï¼Œæ­¤å¤„ç”¨ softmax ç¤ºæ„ï¼‰

logits = h @ output_embedding.weight.T  # [V]

loss = F.cross_entropy(logits.unsqueeze(0), torch.tensor([target_id]))

> ğŸ“Œ å®é™…ç”¨ **è´Ÿé‡‡æ ·**ï¼ˆNegative Samplingï¼‰æˆ– **Hierarchical Softmax** åŠ é€Ÿï¼Œé¿å… *O*(*V*) è®¡ç®—ã€‚ 

### âœ… å…­ã€CBOW å­¦åˆ°çš„å‘é‡æœ‰ä»€ä¹ˆç”¨ï¼Ÿï¼ˆç»“åˆä½ éœ€æ±‚ï¼‰

| åº”ç”¨               | ä¸¾ä¾‹                                                         |
| ------------------ | ------------------------------------------------------------ |
| **è¯­ä¹‰ç›¸ä¼¼åº¦**     | `cosine(v_"transformer", v_"reactor") > v_"busbar"`          |
| **ç±»æ¯”æ¨ç†**       | `v_"110kV" - v_"10kV" â‰ˆ v_"220kV" - v_"110kV"`               |
| **ä¸‹æ¸¸ä»»åŠ¡åˆå§‹åŒ–** | ç”¨é¢„è®­ç»ƒè¯å‘é‡åˆå§‹åŒ– NERã€æ–‡æœ¬åˆ†ç±»æ¨¡å‹                       |
| **ä¸­æ–‡åˆ†è¯è¾…åŠ©**   | æ„å»ºè®¾å¤‡åè¯å…¸ï¼ˆå¦‚è¯†åˆ«`"GIS"`æ˜¯`"Gas_Insulated_Switchgear"`ï¼‰ |

### âœ… æ€»ç»“ä¸€å¥è¯ï¼š

> **CBOW æ˜¯ä¸€ç§â€œç”±å‘¨å›´çŒœä¸­å¿ƒâ€çš„æµ…å±‚ç¥ç»ç½‘ç»œï¼Œé€šè¿‡å¹³å‡ä¸Šä¸‹æ–‡è¯å‘é‡é¢„æµ‹ç›®æ ‡è¯ï¼Œé«˜æ•ˆç”Ÿæˆä½ç»´ç¨ å¯†è¯è¡¨ç¤ºâ€”â€”æ˜¯æ„å»ºæ–‡æœ¬ç‰¹å¾çš„ç¬¬ä¸€æ­¥**ã€‚ 



## skip-gram

å’Œcbowç›¸åï¼Œç”±ä¸€ä¸ªè¯é¢„æµ‹ä¸Šä¸‹æ–‡





## transformer



## bert





## mamba

å‚è€ƒæ–‡çŒ®ï¼š

1.[ä¸€æ–‡é€šé€æƒ³é¢ è¦†Transformerçš„Mambaï¼šä»SSMã€HiPPOã€S4åˆ°Mamba(è¢«èª‰ä¸ºMambaæœ€ä½³è§£è¯»)_mambaæ¨¡å‹-CSDNåšå®¢](https://blog.csdn.net/v_JULY_v/article/details/134923301)

2.[ä»€ä¹ˆæ˜¯ Mamba æ¨¡å‹ï¼Ÿ| IBM](https://www.ibm.com/cn-zh/think/topics/mamba-model)

3.[è¶…è¶ŠTransformerçš„é•¿åºåˆ—å»ºæ¨¡ï¼šå…¨é¢è§£æMambaæ¶æ„ - WMW](https://watermelonwater.tech/archives/è¶…è¶ŠTransformerçš„é•¿åºåˆ—å»ºæ¨¡ï¼šå…¨é¢è§£æMambaæ¶æ„#å…³é”®æå‡)

æ ¸å¿ƒæœºåˆ¶SSM

mambaæ¨¡å—å¦‚ä¸‹ï¼šï¼ˆæ•´ä½“æ˜¯ä¸€ä¸ªæ®‹å·®å—ï¼Œä¹˜ç§¯å¤„å¯ä»¥çœ‹ä½œä¸€ä¸ªâ€œé—¨æ§æœºåˆ¶â€ï¼Œå³ä¾§ä¸ºé—¨ï¼‰

![Mamba-2 æ¨¡å—å›¾](https://www.ibm.com/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/s-migr/ul/g/b0/04/mamba-block-1.component.crop-1by1-xl.ts=1755894185577.png/content/adobe-cms/cn/zh/think/topics/mamba-model/jcr:content/root/table_of_contents/body-article-8/image_1923501036)

![é€‰æ‹©æ€§çŠ¶æ€ç©ºé—´æ¨¡å‹æ¶æ„å›¾](https://www.ibm.com/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/s-migr/ul/g/09/3d/mamba-s6-diagram.component.crop-2by1-xl.ts=1755894185161.png/content/adobe-cms/cn/zh/think/topics/mamba-model/jcr:content/root/table_of_contents/body-article-8/image_1502391661_cop)

ç–‘é—®ï¼š

htéšè—çŠ¶æ€åˆ°åº•æ˜¯ä»€ä¹ˆ

